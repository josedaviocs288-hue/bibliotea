<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<title>Novo Empr√©stimo</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{
background:#e3e3e8;
font-family:Segoe UI;
}

/* MENU LATERAL */

.menu{
height:100vh;
width:240px;
background:#8B2E2E;
position:fixed;
left:-240px;
top:0;
transition:0.3s;
padding-top:20px;
}

.menu a{
display:block;
color:white;
text-decoration:none;
padding:18px;
font-size:18px;
}

.menu a:hover{
background:#a03a3a;
}

.menu.active{
left:0;
}

/* BOT√ÉO ABRIR MENU */

.abrir{
font-size:30px;
cursor:pointer;
color:#8B2E2E;
}

/* CARD */

.card{
max-width:700px;
margin:auto;
padding:30px;
border-radius:10px;
box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

/* CAMPOS */

input, select{
height:50px;
font-size:17px;
}

/* BOT√ÉO */

.btn-menu{
background:#8B2E2E;
color:white;
border:none;
height:50px;
font-size:18px;
}

.btn-menu:hover{
background:#a03a3a;
color:white;
}

</style>

</head>

<body>

<div class="container mt-4">

<span class="abrir" onclick="abrirMenu()">‚ò∞</span>

<h2 class="mt-3">Novo Empr√©stimo</h2>

<div class="card mt-3">

<label>Livro</label>
<select class="form-control mb-3" id="livro"></select>

<label>Leitor</label>
<select class="form-control mb-3" id="leitor"></select>

<label>Data de devolu√ß√£o</label>
<input type="date" class="form-control mb-4" id="devolucao">

<button class="btn btn-menu w-100" onclick="emprestar()">
Emprestar Livro
</button>

</div>

</div>


<!-- MENU LATERAL -->

<div id="menu" class="menu">

<a href="javascript:void(0)" onclick="fecharMenu()">‚¨Ö Fechar</a>

<a href="index.html">üè† In√≠cio</a>

<a href="cadastrar_livro.html">üìö Cadastrar Livro</a>

<a href="cadastrar_leitor.html">üë§ Cadastrar Leitor</a>

<a href="emprestimo.html">üì¶ Empr√©stimo</a>

<a href="livros_emprestados.html">üìã Livros Emprestados</a>

</div>


<script>

function abrirMenu(){
document.getElementById("menu").classList.add("active")
}

function fecharMenu(){
document.getElementById("menu").classList.remove("active")
}

let livros = JSON.parse(localStorage.getItem("livros")) || []
let leitores = JSON.parse(localStorage.getItem("leitores")) || []
let emprestimos = JSON.parse(localStorage.getItem("emprestimos")) || []

let livro = document.getElementById("livro")
let leitor = document.getElementById("leitor")

livros.forEach((l,i)=>{

if(l.disponivel !== false){

livro.innerHTML += `<option value="${i}">${l.nome}</option>`

}

})

leitores.forEach((l,i)=>{

leitor.innerHTML += `<option value="${i}">${l.nome}</option>`

})

function emprestar(){

let l = livro.value
let p = leitor.value

let devolucao = document.getElementById("devolucao").value

emprestimos.push({

livro:livros[l].nome,
autor:livros[l].autor,
genero:livros[l].genero,
imagem:livros[l].imagem,
leitor:leitores[p].nome,
data:new Date().toLocaleDateString(),
devolucao:devolucao

})

livros[l].disponivel = false

localStorage.setItem("emprestimos",JSON.stringify(emprestimos))
localStorage.setItem("livros",JSON.stringify(livros))

alert("Livro emprestado com sucesso!")

location.reload()

}

</script>

</body>
</html>
