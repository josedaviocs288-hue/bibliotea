<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<title>RelatÃ³rio da Biblioteca</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{
background:#f4f6f9;
font-family:Segoe UI;
}

.menu{
height:100vh;
width:240px;
background:#8B0000;
position:fixed;
left:-240px;
top:0;
transition:0.3s;
padding-top:20px;
}

.menu a{
display:block;
color:white;
text-decoration:none;
padding:18px;
font-size:18px;
}

.menu a:hover{
background:#a00000;
}

.menu.active{
left:0;
}

.abrir{
font-size:30px;
cursor:pointer;
color:#8B0000;
}

.card-relatorio{

padding:30px;
border-radius:10px;
color:white;
text-align:center;
font-size:22px;

}

.total{ background:#007bff; }
.emprestados{ background:#ffc107; color:black;}
.disponiveis{ background:#28a745; }
.atrasados{ background:#dc3545; }

</style>

</head>

<body>

<div class="container mt-4">

<span class="abrir" onclick="abrirMenu()">â˜°</span>

<h2 class="mt-3">RelatÃ³rio da Biblioteca</h2>

<div class="row mt-4 g-4">

<div class="col-md-3">
<div class="card-relatorio total">
ğŸ“š<br>
Total de Livros
<br>
<span id="totalLivros"></span>
</div>
</div>

<div class="col-md-3">
<div class="card-relatorio emprestados">
ğŸ“–<br>
Emprestados
<br>
<span id="totalEmprestados"></span>
</div>
</div>

<div class="col-md-3">
<div class="card-relatorio disponiveis">
ğŸ“—<br>
DisponÃ­veis
<br>
<span id="totalDisponiveis"></span>
</div>
</div>

<div class="col-md-3">
<div class="card-relatorio atrasados">
â°<br>
Atrasados
<br>
<span id="totalAtrasados"></span>
</div>
</div>

</div>


<div class="mt-5">

<h4>EmprÃ©stimos do mÃªs</h4>

<table class="table table-striped">

<tr>
<th>Livro</th>
<th>Leitor</th>
<th>Data</th>
<th>DevoluÃ§Ã£o</th>
</tr>

<tbody id="lista"></tbody>

</table>

</div>

</div>


<!-- MENU LATERAL -->

<div id="menu" class="menu">

<a href="javascript:void(0)" onclick="fecharMenu()">â¬… Fechar</a>

<a href="index.html">ğŸ  InÃ­cio</a>

<a href="cadastrar_livro.html">ğŸ“š Cadastrar Livro</a>

<a href="cadastrar_leitor.html">ğŸ‘¤ Cadastrar Leitor</a>

<a href="emprestimo.html">ğŸ“¦ EmprÃ©stimo</a>

<a href="livros_emprestados.html">ğŸ“‹ Livros Emprestados</a>

<a href="relatorio.html">ğŸ“Š RelatÃ³rio</a>

</div>


<script>

function abrirMenu(){
document.getElementById("menu").classList.add("active")
}

function fecharMenu(){
document.getElementById("menu").classList.remove("active")
}

let livros = JSON.parse(localStorage.getItem("livros")) || []
let emprestimos = JSON.parse(localStorage.getItem("emprestimos")) || []

let hoje = new Date()

let atrasados = 0

emprestimos.forEach(e=>{

let data = new Date(e.devolucao)

if(data < hoje){
atrasados++
}

})


document.getElementById("totalLivros").innerText = livros.length
document.getElementById("totalEmprestados").innerText = emprestimos.length
document.getElementById("totalDisponiveis").innerText = livros.filter(l=>l.disponivel).length
document.getElementById("totalAtrasados").innerText = atrasados


emprestimos.forEach(e=>{

lista.innerHTML+=`

<tr>

<td>${e.livro}</td>

<td>${e.leitor}</td>

<td>${e.data}</td>

<td>${e.devolucao}</td>

</tr>

`

})

</script>

</body>
</html>